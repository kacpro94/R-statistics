---
title: "Zadanie 3"
author: "Kacper Prorok"
date: "2024-05-01"
output: 
  html_document:
    theme: journal
    toc: yes
    toc_float:
      collapsed: true
---

Tre zadania:
Za pomoc odpowiednich symulacji zbada moc testu Komogorowa-Smirnowa w przypadku, gdy rozwa偶ane pr贸bki danych pochodz w rozkad贸w2 o r贸偶nej liczbie stopni swobody. Do cel贸w symulacji prosz przesun generowane dane tak, by miay t sam warto oczekiwan.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(tidyr)
library(tseries)
library(nortest)
```

# Symulacja 1

## Parametry symulacji

```{r}
#ilo symulacji
N <- 1000
#wartoci oczekiwane
m<-5
#stopnie swobody 1 rozkadu
df1<-seq(6,70,by=1)
#stopnie swobody 2 rozkadu
df2<-c(15,30,60)
#dugo pr贸by
lengths <- c(10,20,100,500)

params <- expand.grid(m=m,df1=df1,df2=df2, length = lengths)


```


## Kod

```{r}
chisq2<-function(m1,df1,df2,n,K){
  
  mean(sapply(1:K,function(i) ks.test(rchisq(n,df1),rchisq(n,df2))$p.value<0.05))
  
}


```


```{r message=FALSE, warning=FALSE}


wyniki<-c()
dlugosc<-c(1:nrow(params))
for(i in dlugosc){
  wyniki[i]<-chisq2(params[i,1],params[i,2],params[i,3],params[i,4],1000)
}

params<-cbind(params,"moc"=wyniki)



```


## Wykres 

```{r}

ggplot(params,aes(x=df1,y=moc,color=factor(df2)))+
  geom_line()+
  facet_wrap(~length,nrow=2)+
   labs(title = "Moc testu dla r贸偶nych stopni swobody przy m=5",
       x="stopnie swobody pierwszego rozkadu",
       y="moc testu",
       color="stopnie swobody drugiego rozkadu")
```


*Nad wykresami znajduje si liczno pr贸bki*


# Symulacja 2

## Parametry symulacji

```{r}
#ilo symulacji
N <- 1000
#wartoci oczekiwane
m<-15
#stopnie swobody 1 rozkadu
df1<-seq(6,70,by=1)
#stopnie swobody 2 rozkadu
df2<-c(15,30,60)
#dugo pr贸by
lengths <- c(10,20,100,500)

params <- expand.grid(m=m,df1=df1,df2=df2, length = lengths)


```

## Kod

```{r message=FALSE, warning=FALSE}


wyniki<-c()
dlugosc<-c(1:nrow(params))
for(i in dlugosc){
  wyniki[i]<-chisq2(params[i,1],params[i,2],params[i,3],params[i,4],1000)
}

params<-cbind(params,"moc"=wyniki)

```

## Wykres

```{r}

ggplot(params,aes(x=df1,y=moc,color=factor(df2)))+
  geom_line()+
  facet_wrap(~length,nrow=2)+
   labs(title = "Moc testu dla r贸偶nych stopni swobody przy m=15",
       x="stopnie swobody pierwszego rozkadu",
       y="moc testu",
       color="stopnie swobody drugiego rozkadu")
```


*Nad wykresami znajduje si liczno pr贸bki*

# Symulacja 3

## Parametry symulacji

```{r}
#ilo symulacji
N <- 1000
#wartoci oczekiwane
m<-50
#stopnie swobody 1 rozkadu
df1<-seq(6,70,by=1)
#stopnie swobody 2 rozkadu
df2<-c(15,30,60)
#dugo pr贸by
lengths <- c(10,20,100,500)

params <- expand.grid(m=m,df1=df1,df2=df2, length = lengths)


```

## Kod

```{r message=FALSE, warning=FALSE}


wyniki<-c()
dlugosc<-c(1:nrow(params))
for(i in dlugosc){
  wyniki[i]<-chisq2(params[i,1],params[i,2],params[i,3],params[i,4],1000)
}

params<-cbind(params,"moc"=wyniki)

```

## Wykres

```{r}

ggplot(params,aes(x=df1,y=moc,color=factor(df2)))+
  geom_line()+
  facet_wrap(~length,nrow=2)+
   labs(title = "Moc testu dla r贸偶nych stopni swobody przy m=50",
       x="stopnie swobody pierwszego rozkadu",
       y="moc testu",
       color="stopnie swobody drugiego rozkadu")
```


*Nad wykresami znajduje si liczno pr贸bki*


# Wnioski

- dob贸r wartoci oczekiwanej nie ma wpywu na zachowanie mocy testu

- wraz ze zwiszkaniem si licznoci pr贸bki ronie moc testu

- wraz ze zwikszaniem stopni swobody rozkad贸w moc testu maleje 