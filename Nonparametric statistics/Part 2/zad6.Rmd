---
title: "Zadanie 6"
author: "Kacper Prorok"
date: "2024-04-21"
output: 
  html_document:
    theme: journal
    toc: yes
    toc_float:
      collapsed: true
---



Za pomoc odpowiednich symulacji zbada odsetek odrzuce prawdziwej hipotezy g贸wnej (tzn. bd
I rodzaju) w tecie istotnoci wsp贸czynnika korelacji w przypadku, gdy dane pochodz z rozkad贸w 2
(o r贸偶nych stopniach swobody).

Symulacja odbdzie si na nastpujcych wartociach:


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyr)
```

# Symulacja


## Parametry symulacji

```{r}
#ilo symulacji
N <- 500
#wartoci oczekiwane
df1 <- seq(3,45,by=3)
#poziomy istotnoci
#dugo pr贸by
lengths <- c(5,25,100,500)
df2 <- seq(3,45,by=3)
params <- expand.grid(df1 = df1, df2=df2, length = lengths)


```

## Kod

```{r}
Spearman<-function(n,df1,df2,K){
  mean(sapply(1:K, function(i) cor.test(rchisq(n,df1),rchisq(n,df2),method="spearman")$p.value<0.05))
} 

Pearson<-function(n,df1,df2,K){
 mean(sapply(1:K, function(i) cor.test(rchisq(n,df1),rchisq(n,df2))$p.value<0.05))
}

set.seed(420)

wyniki<-c()
dlugosc<-c(1:nrow(params))
for(i in dlugosc){
  wyniki[i]<-Spearman(params[i,3],params[i,1],params[i,2],500)
}


wyniki1<-c()
dlugosc<-c(1:nrow(params))
for(i in dlugosc){
  wyniki1[i]<-Pearson(params[i,3],params[i,1],params[i,2],500)
}

params<-cbind(params,"Spearman"=wyniki)
params<-cbind(params,"Pearson"=wyniki1)

params<-params%>%
  pivot_longer(cols=c("Spearman","Pearson"),names_to="Test",values_to = "Odsetek")
```

## Wykres 1

```{r}
wykres<-params%>%
  filter(Test=="Spearman")%>%
  ggplot()+
  geom_point(aes(x=df1,y=df2,color = Odsetek))+
  facet_wrap(~length)+
  labs(title = "Odsetek odrzuce prawdziwej H0 - test Spearman",
       x="stopnie swobody 1 rozkadu",
       y="stopnie swobody 2 rozkadu",
       color="Odsetek odrzuce")
wykres



```

*liczba danych znajduje si nad wykresami*


## Wykres 2

```{r}
wykres<-params%>%
  filter(Test=="Pearson")%>%
  ggplot()+
  geom_point(aes(x=df1,y=df2,color = Odsetek))+
  facet_wrap(~length)+
  labs(title = "Odsetek odrzuce prawdziwej H0 - test Pearson",
       x="stopnie swobody 1 rozkadu",
       y="stopnie swobody 2 rozkadu",
       color="Odsetek odrzuce")
wykres
```


*liczba danych znajduje si nad wykresami*

# Wnioski

- Odsetek odrzuce prawdziwej hipotezy H0 jest w przypadku obydw贸ch test贸w bardzo bliski 0.05, czyli poziomu istotnoci

- W przypadku obydw贸ch test贸w odsetek odrzuce hipotezy H0 nie zmienia si w zale偶noci od stopni swobody rozkad贸w

- W przypadku obyd贸wch test贸w odsetek odrzuce hipotezy H0 nie zmienia si w zale偶noci od liczby danych

- W przyadku testu Spearmana widzimy ciekawe zachowanie gdy pr贸bka ma ma liczno (n=5) - odsetek odrzuce hipotezy h0 jest ni偶szy i wynosi okoo 0.02
