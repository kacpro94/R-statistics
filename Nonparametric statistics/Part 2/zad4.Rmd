---
title: "zad 4 kartka 2"
author: "Kacper Prorok"
date: "2024-04-15"
output: 
  html_document:
    theme: journal
    toc: yes
    toc_float:
      collapsed: true
---

Zadanie polegao na:

Za pomoc odpowiednich symulacji zbada odsetek odrzuce prawdziwej hipotezy g贸wnej (tzn. bd
I rodzaju) w tecie Manna-Whitneya i w tecie r贸wnoci dw贸ch wartoci oczekiwanych (funkcja
t.test) w przypadku, gdy dane pochodz z rozkad贸w 2 o r贸偶niej liczbie stopni swobody.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
```

# Symulacja

## Parametry symulacji

```{r message=FALSE, warning=FALSE}
#stopnie swobody 1 rozkadu
df1<-c(20,40,60)
#stopnie swobody 2 rozkadu
df2<-seq(10,70,by=1)
#licznoci pr贸bek
n<-c(20,100,500)
tabelka<-expand.grid(n=n,df_badane=df1,df_przedzial=df2)

```

## Kod

```{r}
Mann1<-function(df1,df2,n){
  mean(sapply(1:256, function(i) wilcox.test(rchisq(n,df=df1)-df1,rchisq(n,df=df2)-df2)$p.value<0.05
              ))
}

Mann2<-function(df1,df2,n){
  mean(sapply(1:256, function(i) wilcox.test((rchisq(n,df=df1)-df1)/sqrt(2*df1),(rchisq(n,df=df2)-df2)/sqrt(2*df2))$p.value<0.05
  ))
}


ttest1<-function(df1,df2,n){
  
  mean(sapply(1:256, function(i) t.test(rchisq(n,df=df1)-df1,rchisq(n,df=df2)-df2,mu=0)$p.value<0.05))
}


ttest2<-function(df1,df2,n){
  
  mean(sapply(1:256, function(i) t.test((rchisq(n,df=df1)-df1)/sqrt(2*df1),(rchisq(n,df=df2)-df2)/sqrt(2*df2),mu=0)$p.value<0.05))
}

MannStand<-c()
MannBezStand<-c()
TtestStand<-c()
TtestBezStand<-c()
for(i in 1:nrow(tabelka))
{
  MannStand[i]<-Mann2(tabelka[i,2],tabelka[i,3],tabelka[i,1])
  MannBezStand[i]<-Mann1(tabelka[i,2],tabelka[i,3],tabelka[i,1])
  TtestStand[i]<-ttest2(tabelka[i,2],tabelka[i,3],tabelka[i,1])
 TtestBezStand[i]<-ttest1(tabelka[i,2],tabelka[i,3],tabelka[i,1])
}
tabelka<-cbind(tabelka,MannStand)
tabelka<-cbind(tabelka,MannBezStand)
tabelka<-cbind(tabelka,TtestStand)
tabelka<-cbind(tabelka,TtestBezStand)

nowa_tabelka<-tabelka%>%
  pivot_longer(cols=c("MannStand","MannBezStand","TtestStand","TtestBezStand"),names_to = "Test",values_to = "wynik")

```

## Wykres

```{r}
nowa_tabelka%>%
  ggplot(aes(df_przedzial,wynik,color=Test))+
  geom_line()+
  labs(x="stopnie swobody drugiego rozkadu",y="Prawdopodobiestwo popenienia bdu 1 rodzaju")+
  facet_grid(n~df_badane)


```


*Na osi X znajduj si stopnie swobody drugiego rozkadu, na osi Y znajduje si odestek odrzuce prawdziwej hipotezy h0. Na samej g贸rze wykresu widzimy stopnie swobody pierwszego rozkadu, a po prawej stronie liczb danych*

# Wnioski

- przy mniejszej iloci danych testy zachowuj si podobnie i maj podobny odsetek odrzuce prawdziwej hipotezy g贸wnej

- Przy n=500 dla testu Manna-Whitneya bez standaryzacji widzimy du偶y wzrost tego odsetka, kt贸ry najmniejszy jest gdy dwa rozkady maj tyle samo stopni swobody, a w innych miejscach ronie